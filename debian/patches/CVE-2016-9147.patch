#diff --git a/CHANGES b/CHANGES
#index a53e413..3babc7c 100644
#--- a/CHANGES
#+++ b/CHANGES
#@@ -1,3 +1,8 @@
#+4510.	[security]	Named mishandled some responses where covering RRSIG
#+			records are returned without the requested data
#+			resulting in a assertion failure. (CVE-2016-9147)
#+			[RT #43548]
#+
# 	--- 9.10.4-P4 released ---
# 
# 4489.	[security]	It was possible to trigger assertions when processing
Index: bind9-9.10.3.dfsg.P4/lib/dns/resolver.c
===================================================================
--- bind9-9.10.3.dfsg.P4.orig/lib/dns/resolver.c	2017-01-09 08:37:07.829610230 -0500
+++ bind9-9.10.3.dfsg.P4/lib/dns/resolver.c	2017-01-09 08:37:07.825610182 -0500
@@ -6916,15 +6916,19 @@
 						 * a CNAME or DNAME).
 						 */
 						INSIST(!external);
-						if ((rdataset->type !=
-						     dns_rdatatype_cname) ||
-						    !found_dname ||
-						    (aflag ==
-						     DNS_RDATASETATTR_ANSWER))
+						/*
+						 * Don't use found_cname here
+						 * as we have just set it
+						 * above.
+						 */
+						if (cname == NULL &&
+						    !found_dname &&
+						    aflag ==
+						     DNS_RDATASETATTR_ANSWER)
 						{
 							have_answer = ISC_TRUE;
-							if (rdataset->type ==
-							    dns_rdatatype_cname)
+							if (found_cname &&
+							    cname == NULL)
 								cname = name;
 							name->attributes |=
 							    DNS_NAMEATTR_ANSWER;
