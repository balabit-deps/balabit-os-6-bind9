#diff --git a/CHANGES b/CHANGES
#index a53e413..0ca2f93 100644
#--- a/CHANGES
#+++ b/CHANGES
#@@ -1,3 +1,7 @@
#+4508.	[security]	Named incorrectly tried to cache TKEY records which
#+			could trigger a assertion failure when there was
#+			a class mismatch. (CVE-2016-9131) [RT #43522]
#+
# 	--- 9.10.4-P4 released ---
# 
# 4489.	[security]	It was possible to trigger assertions when processing
Index: bind9-9.10.3.dfsg.P4/lib/dns/resolver.c
===================================================================
--- bind9-9.10.3.dfsg.P4.orig/lib/dns/resolver.c	2017-01-09 08:37:00.305520045 -0500
+++ bind9-9.10.3.dfsg.P4/lib/dns/resolver.c	2017-01-09 08:37:00.301519997 -0500
@@ -6795,6 +6795,19 @@
 					log_formerr(fctx, "NSEC3 in answer");
 					return (DNS_R_FORMERR);
 				}
+				if (rdataset->type == dns_rdatatype_tkey) {
+					/*
+					 * TKEY is not a valid record in a
+					 * response to any query we can make.
+					 */
+					log_formerr(fctx, "TKEY in answer");
+					return (DNS_R_FORMERR);
+				}
+				if (rdataset->rdclass != fctx->res->rdclass) {
+					log_formerr(fctx, "Mismatched class "
+						    "in answer");
+					return (DNS_R_FORMERR);
+				}
 
 				/*
 				 * Apply filters, if given, on answers to reject
@@ -6981,6 +6994,12 @@
 			     rdataset != NULL;
 			     rdataset = ISC_LIST_NEXT(rdataset, link))
 			{
+				if (rdataset->rdclass != fctx->res->rdclass) {
+					log_formerr(fctx, "Mismatched class "
+						    "in answer");
+					return (DNS_R_FORMERR);
+				}
+
 				/*
 				 * Only pass DNAME or RRSIG(DNAME).
 				 */
